<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
  <title>The Vault – Y2K Sportsbook</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link href="https://unpkg.com/@walletconnect/modal@2.4.2/dist/style.css" rel="stylesheet" />
  <style>
    /* Paste all your CSS here exactly as you wrote it */
    /* ... truncated for space but assumed correct from your prior version */
  </style>
</head>
<body>
  <div class="background">
    <div class="gradient-sphere"></div>
  </div>

  <div class="container">
    <div class="glass-card">
      <div class="header">
        <div class="logo">Y2K</div>
        <div class="subtitle">VAULT ACCESS</div>
      </div>

      <div class="verification-container">
        <div class="verification-ring">
          <svg class="progress-ring" width="120" height="120">
            <circle class="progress-ring-circle" stroke="#ffffff20" stroke-width="4" fill="transparent" r="52" cx="60" cy="60"/>
            <circle class="progress-ring-path" stroke="url(#gradient)" stroke-width="4" fill="transparent" r="52" cx="60" cy="60"/>
          </svg>
          <div class="verification-status" id="verificationIcon">
            <svg class="lock-icon" viewBox="0 0 24 24" width="32" height="32">
              <path d="M12 1C8.676 1 6 3.676 6 7v2H4v14h16V9h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4z"/>
            </svg>
          </div>
        </div>
        <div class="amount-required">
          <div class="amount">4,000,000</div>
          <div class="token">Y2K REQUIRED</div>
        </div>
      </div>

      <div class="status-container">
        <div class="status-item" id="connection-status">
          <div class="status-dot"></div>
          <span>Ready to Connect</span>
        </div>
        <div class="status-item" id="verification-status">
          <div class="status-dot"></div>
          <span>Awaiting Verification</span>
        </div>
        <div class="status-item" id="token-status">
          <div class="status-dot"></div>
          <span>Token Check Pending</span>
        </div>
      </div>

      <button id="connectBtn" class="connect-button">
        <span class="button-text">Connect Wallet</span>
        <span class="button-icon">→</span>
      </button>

      <div id="status" class="status-message"></div>
    </div>
  </div>

  <!-- Dependencies FIRST -->
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@walletconnect/web3modal@2.4.2/dist/index.umd.js"></script>

  <!-- Entry Logic -->
  <script>
    const Y2K_TOKEN = "0xB4Df7d2A736Cc391146bB0dF4277E8F68247Ac6d";
    const Y2K_DECIMALS = 18;
    const REQUIRED_TOKENS = 4000000;

    function updateStatus(message) {
      document.getElementById("status").innerText = message;
    }

    function setStatusActive(id, isActive) {
      const el = document.getElementById(id);
      if (isActive) el.classList.add("active");
      else el.classList.remove("active");
    }

    function updateProgress(percent) {
      const circle = document.querySelector(".progress-ring-path");
      const radius = circle.r.baseVal.value;
      const circumference = radius * 2 * Math.PI;
      const offset = circumference - (percent / 100 * circumference);
      circle.style.strokeDashoffset = offset;
    }

    function setLoading(state) {
      const ring = document.querySelector(".verification-container");
      ring.classList.toggle("loading", state);
    }

    function formatNumber(n) {
      return new Intl.NumberFormat().format(n);
    }

    document.addEventListener("DOMContentLoaded", () => {
      const connectBtn = document.getElementById("connectBtn");

      connectBtn.addEventListener("click", async () => {
        setLoading(true);
        updateStatus("Initializing secure connection...");
        updateProgress(0);
        setStatusActive("connection-status", true);

        try {
          const modal = new window.Web3Modal.default({
            projectId: "36c402e4989b8426f99d329788a526fc",
            chains: ["eip155:25"],
            themeMode: "dark",
            standaloneChains: ["eip155:25"],
            explorer: {
              name: "Y2K Vault",
              url: "https://y2kcoin.org",
              description: "Y2K Sportsbook",
              recommend: true
            }
          });

          const provider = await modal.connect();
          const [namespace, , account] = provider.accounts[0].split(":");

          if (namespace !== "eip155") {
            updateStatus("Unsupported chain.");
            return;
          }

          updateProgress(33);
          setStatusActive("verification-status", true);
          updateStatus("Verifying wallet credentials...");

          const ethersProvider = new ethers.JsonRpcProvider("https://evm.cronos.org");
          const token = new ethers.Contract(Y2K_TOKEN, [
            "function balanceOf(address) view returns (uint256)"
          ], ethersProvider);

          const balance = await token.balanceOf(account);
          const y2k = parseFloat(ethers.formatUnits(balance, Y2K_DECIMALS));

          updateProgress(66);
          setStatusActive("token-status", true);
          updateStatus("Checking Y2K balance...");

          if (y2k >= REQUIRED_TOKENS) {
            updateProgress(100);
            updateStatus("Access granted – Welcome to The Vault");
            setTimeout(() => window.location.href = "vault.html", 1500);
          } else {
            updateStatus(`Access denied – You need ${formatNumber(REQUIRED_TOKENS)} Y2K`);
            setStatusActive("token-status", false);
            updateProgress(66);
          }
        } catch (err) {
          console.error(err);
          updateStatus("Wallet connection failed.");
          setStatusActive("connection-status", false);
        } finally {
          setLoading(false);
        }
      });
    });
  </script>
</body>
</html>
